@model InsuranceApp.Models.Partner

@{
    ViewData["Title"] = $"Partner Details - {Model.FullName}";
}

<div class="container-fluid" style="max-width: 960px; padding: 0.75rem; padding-bottom: 3rem; margin: 0 auto;">
    <!-- Compact Header -->
    <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0" style="font-size: 1.1rem;">
            <i class="fas fa-user-circle text-primary" style="font-size: 1rem;"></i> @Model.FullName
        </h5>
        <div>
            <a asp-action="Index" class="btn btn-sm btn-outline-secondary py-1 px-2" style="font-size: 0.8rem;">
                <i class="fas fa-arrow-left"></i> Back
            </a>
            <a asp-action="AddPolicy" asp-route-id="@Model.Id" class="btn btn-sm btn-success py-1 px-2 ml-1" style="font-size: 0.8rem;">
                <i class="fas fa-plus"></i> Policy
            </a>
        </div>
    </div>

    <!-- Compact Stats Row -->
    <div class="row mb-2" style="font-size: 0.8rem;">
        <div class="col-3">
            <div class="text-center p-2" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border-radius: 0.5rem;">
                <i class="fas fa-user" style="font-size: 1rem;"></i>
                <div style="font-size: 0.65rem; opacity: 0.9;">Type</div>
                <div class="font-weight-bold" style="font-size: 0.75rem;">@Model.PartnerTypeId.ToString()</div>
            </div>
        </div>
        <div class="col-3">
            <div class="text-center p-2" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 0.5rem;">
                <i class="fas fa-file" style="font-size: 1rem;"></i>
                <div style="font-size: 0.65rem; opacity: 0.9;">Policies</div>
                <div class="font-weight-bold" style="font-size: 0.75rem;">@Model.PolicyCount</div>
            </div>
        </div>
        <div class="col-3">
            <div class="text-center p-2" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border-radius: 0.5rem;">
                <i class="fas fa-euro-sign" style="font-size: 1rem;"></i>
                <div style="font-size: 0.65rem; opacity: 0.9;">Amount</div>
                <div class="font-weight-bold" style="font-size: 0.75rem;">@Model.TotalPolicyAmount.ToString("C0")</div>
            </div>
        </div>
        <div class="col-3">
            <div class="text-center p-2" style="background: linear-gradient(135deg, @(Model.IsForeign ? "#f59e0b" : "#6b7280") 0%, @(Model.IsForeign ? "#d97706" : "#4b5563") 100%); color: white; border-radius: 0.5rem;">
                <i class="fas fa-globe" style="font-size: 1rem;"></i>
                <div style="font-size: 0.65rem; opacity: 0.9;">Status</div>
                <div class="font-weight-bold" style="font-size: 0.75rem;">@(Model.IsForeign ? "Foreign" : "Local")</div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Personal Information -->
        <div class="col-md-6 mb-2">
            <div class="card border-0 shadow-sm" style="font-size: 0.85rem;">
                <div class="card-header bg-light py-1 px-2" style="font-size: 0.8rem; font-weight: 600;">
                    <i class="fas fa-user text-primary" style="font-size: 0.75rem;"></i> Personal Info
                </div>
                <div class="card-body p-2">
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-user" style="width: 14px;"></i> Name</span>
                        <span class="font-weight-medium">@Model.FullName</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-venus-mars" style="width: 14px;"></i> Gender</span>
                        <span class="font-weight-medium">@Model.Gender.ToString()</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-map-marker-alt" style="width: 14px;"></i> Address</span>
                        <span class="font-weight-medium text-right">@(Model.Address ?? "N/A")</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-user-edit" style="width: 14px;"></i> Created By</span>
                        <span class="font-weight-medium">@Model.CreateByUser</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-start">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-calendar" style="width: 14px;"></i> Created</span>
                        <span class="font-weight-medium">@Model.CreatedAtUtc.ToString("MMM dd, yyyy")</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Partner Details -->
        <div class="col-md-6 mb-2">
            <div class="card border-0 shadow-sm" style="font-size: 0.85rem;">
                <div class="card-header bg-light py-1 px-2" style="font-size: 0.8rem; font-weight: 600;">
                    <i class="fas fa-id-card text-primary" style="font-size: 0.75rem;"></i> Partner Details
                </div>
                <div class="card-body p-2">
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-hashtag" style="width: 14px;"></i> Partner #</span>
                        <code style="font-size: 0.75rem;">@Model.PartnerNumber</code>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-fingerprint" style="width: 14px;"></i> PIN</span>
                        <code style="font-size: 0.75rem;">@(Model.CroatianPIN ?? "N/A")</code>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-barcode" style="width: 14px;"></i> Code</span>
                        <code style="font-size: 0.75rem;">@Model.ExternalCode</code>
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-1 pb-1" style="border-bottom: 1px solid #f0f0f0;">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-building" style="width: 14px;"></i> Type</span>
                        <span class="badge @(Model.PartnerTypeId.ToString() == "Individual" ? "badge-primary" : "badge-info")" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                            @Model.PartnerTypeId.ToString()
                        </span>
                    </div>
                    <div class="d-flex justify-content-between align-items-start">
                        <span class="text-muted" style="font-size: 0.75rem;"><i class="fas fa-globe" style="width: 14px;"></i> Status</span>
                        <span class="badge @(Model.IsForeign ? "badge-warning" : "badge-success")" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                            @(Model.IsForeign ? "Foreign" : "Domestic")
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Policies Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm" style="font-size: 0.85rem;">
                <div class="card-header bg-light py-1 px-2 d-flex justify-content-between align-items-center" style="font-size: 0.8rem; font-weight: 600;">
                    <span>
                        <i class="fas fa-file-contract text-primary" style="font-size: 0.75rem;"></i> Policies 
                        <span class="badge badge-primary ml-1" style="font-size: 0.65rem; padding: 0.2rem 0.4rem;">@Model.Policies.Count</span>
                    </span>
                    <a asp-action="AddPolicy" asp-route-id="@Model.Id" class="btn btn-sm btn-success py-0 px-2" style="font-size: 0.75rem;">
                        <i class="fas fa-plus"></i> Add
                    </a>
                </div>
                <div class="card-body p-0">
                    @if (Model.Policies.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover table-sm mb-0" style="font-size: 0.8rem;">
                                <thead class="thead-light" style="font-size: 0.75rem;">
                                    <tr>
                                        <th class="py-1 px-2" style="font-weight: 600;"><i class="fas fa-hashtag"></i> Policy Number</th>
                                        <th class="text-right py-1 px-2" style="font-weight: 600;"><i class="fas fa-euro-sign"></i> Amount</th>
                                        <th class="py-1 px-2" style="font-weight: 600;"><i class="fas fa-calendar"></i> Created</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var policy in Model.Policies.OrderByDescending(p => p.CreatedAtUtc))
                                    {
                                        <tr>
                                            <td class="py-1 px-2"><code style="font-size: 0.75rem; color: #6366f1;">@policy.PolicyNumber</code></td>
                                            <td class="text-right py-1 px-2"><strong class="text-success">@policy.Amount.ToString("C")</strong></td>
                                            <td class="py-1 px-2" style="font-size: 0.75rem;">@policy.CreatedAtUtc.ToString("MMM dd, yyyy")</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="text-center py-2" style="font-size: 0.8rem;">
                            <i class="fas fa-file-invoice text-muted" style="font-size: 1.5rem;"></i>
                            <p class="text-muted mb-1 mt-1" style="font-size: 0.75rem;">No policies found</p>
                            <a asp-action="AddPolicy" asp-route-id="@Model.Id" class="btn btn-sm btn-success py-1 px-2" style="font-size: 0.75rem;">
                                <i class="fas fa-plus"></i> Add First Policy
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
